<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Rock Paper Scissors</title>
</head>
<body>
  
  <script>
    
    let possibleChoice = [
      'rock', 
      'paper', 
      'scissors'
    ]

    let score = {
      player: 0,
      computer: 0
    }

    // Generates a random selection for the computer
    function computerPlay() {
      return possibleChoice[Math.floor(Math.random() * possibleChoice.length)];
    }

    // Ensures player enters valid choice
    function validate(playerSelection) {
        return possibleChoice.includes(playerSelection.toLowerCase());
      }

    // The game
    function game(n = 5) {
      for (let round = 0; round < n; round ++) {
      let playerSelection = prompt('Rock, Paper or Scissors?');
      let computerSelection = computerPlay();
      if (validate(playerSelection)) {
            console.log(playRound(playerSelection, computerSelection));
          } else {
            alert('Invalid input, please choose between rock, paper, or scissors!');
      }
      }

      // Returns the results
      if (score.player > score.computer) {
        alert("Congratulations! You won the game");
      } else if (score.player < score.computer) {
        alert("Sorry you lost the game :( Better luck next time!");
      } else {
        alert("It's a draw!");
      }
    }

    // Counts the scores
    function updateScore(name) {
      score[name] += 1;
    }

    function playRound(playerSelection, computerSelection) {
        if (playerSelection.toLowerCase() == computerSelection.toLowerCase()) {
          return `Draw, you both select ${playerSelection.toLowerCase()}`;
        } else if ((playerSelection.toLowerCase() == 'rock') && (computerSelection.toLowerCase() == 'paper')) {
          // updateScore('computer');
          return `You lose this round! ${computerSelection.toLowerCase()} beats ${playerSelection.toLowerCase()}`;
        } else if ((playerSelection.toLowerCase() == 'rock') && (computerSelection.toLowerCase() == 'scissors')) {
          // updateScore('player');
          return `You win this round! ${playerSelection.toLowerCase()} beats ${computerSelection.toLowerCase()}`;
        } else if ((playerSelection.toLowerCase() == 'paper') && (computerSelection.toLowerCase() == 'scissors')) {
          // updateScore('computer');
          return `You lose this round! ${computerSelection.toLowerCase()} beats ${playerSelection.toLowerCase()}`;
        } else if ((playerSelection.toLowerCase() == 'paper') && (computerSelection.toLowerCase() == 'rock')) {
          // updateScore('player');
          return `You win this round! ${playerSelection.toLowerCase()} beats ${computerSelection.toLowerCase()}`;
        } else if ((playerSelection.toLowerCase() == 'scissors') && (computerSelection.toLowerCase() == 'rock')) {
          // updateScore('computer');
          return `You lose this round! ${computerSelection.toLowerCase()} beats ${playerSelection.toLowerCase()}`;
        } else if ((playerSelection.toLowerCase() == 'scissors') && (computerSelection.toLowerCase() == 'paper')) {
          // updateScore('player');
          return `You win this round! ${playerSelection.toLowerCase()} beats ${computerSelection.toLowerCase()}`;
        }
      }

      game();

  </script>

</body>
</html>